difficulty.txt
Problem: ZIP Radius Filtering for /providers
We needed to support filtering hospitals within a given radius of a ZIP code. This required geocoding (ZIP → lat/lon) and distance calculation.

❌ Attempt 1: Nominatim API (geopy)
Frequent timeouts and HTTP 429 errors

Not suitable for bulk ETL or real-time queries
→ Rejected due to rate limits

❌ Attempt 2: PostGIS in PostgreSQL
Ideal for geospatial queries (e.g. ST_DistanceSphere)

Supabase doesn't support PostGIS in shared/free-tier
→ Rejected due to platform limitations

✅ Final: SimpleMaps ZIP Dataset
Used SimpleMaps free ZIP → lat/lon CSV

Joined coordinates in ETL

Stored lat/lon in provider records

Used geopy.distance.geodesic() at runtime for filtering

Trade-offs
Method	Pros	Cons
Nominatim	Easy to use	Rate-limited, unreliable
PostGIS	SQL-native, scalable	Not available on Supabase
SimpleMaps ✅	Fast, offline, free	Slight inaccuracy possible

Conclusion: SimpleMaps + Python was the best cost-free, offline solution under Supabase constraints.